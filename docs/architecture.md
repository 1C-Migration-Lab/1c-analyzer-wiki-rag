# Архитектура проекта

## Общий пайплайн

```mermaid
graph LR
    A[1C XML + BSL] --> B[Parser<br/>(Extracts IR)]
    B --> C[Wiki Generator<br/>(Markdown/HTML)]
    C --> D[RAG System<br/>(Embeddings + Graph)]
    D --> E[AI Bot<br/>(LLM + context)]
```

## Компоненты системы

### 1. Parser (Анализатор конфигурации)
- Чтение XML-файлов конфигурации 1С
- Извлечение метаданных объектов (справочники, документы, и т.д.)
- Анализ BSL-кода модулей через bsl-parser
- Создание промежуточной модели данных (IR) в JSON формате
- Сохранение промежуточной модели в файл

### 2. Wiki Generator (Генератор документации)
- Преобразование промежуточной модели в wiki-страницы
- Генерация Markdown/HTML документации
- Создание структурированного описания объектов
- Формирование навигации между страницами

### 3. RAG System (Система векторного поиска)
- Разбиение wiki-страниц на смысловые чанки
- Генерация embeddings для текстовых фрагментов
- Хранение векторных представлений в БД (Milvus/Qdrant/FAISS)
- Опционально: хранение графа зависимостей в Neo4j/ArangoDB
  - Граф зависимостей может частично формироваться на этапе Parser (например, связи «Документ → Регистр», «Кто вызывает какой общий модуль»)
  - Эти данные могут быть загружены в Neo4j/ArangoDB для расширенного поиска

### 4. AI Bot (Чат-бот)
- Обработка пользовательских запросов
- Поиск релевантной информации через RAG
  - Бот принимает вопрос
  - Ищет релевантные чанки в векторной БД / графе
  - Формирует prompt
  - Вызывает LLM для финального ответа
- Формирование контекстно-зависимых ответов
- Взаимодействие с LLM для генерации ответов

## Технологический стек

### Backend
- Python/Go для основной логики (или другой язык, по выбору)
- FastAPI/Flask для REST API (или другой фреймворк, по выбору)
- bsl-parser для анализа кода 1С
- Sentence Transformers для embeddings
- Neo4j/ArangoDB для графа зависимостей

### Хранение данных
- Векторная БД (Milvus/Qdrant/FAISS)
- Графовая БД (опционально)
- Файловая система для wiki-страниц

### AI/ML
- OpenAI API / Другие LLM
- Sentence Transformers
- RAG (Retrieval Augmented Generation)

## Процесс работы

1. **Парсинг конфигурации**
   - Загрузка XML и BSL файлов
   - Извлечение метаданных
   - Создание промежуточной JSON-структуры (IR)

2. **Генерация Wiki**
   - Чтение IR (JSON)
   - Применение шаблонов
   - Создание Markdown/HTML

3. **Подготовка RAG**
   - Разбиение на чанки
   - Генерация embeddings
   - Загрузка в векторную БД

4. **Работа бота**
   - Получение запроса
   - Поиск контекста
   - Генерация ответа

## Форматы данных

### Промежуточные форматы
- IR (Intermediate Representation) - JSON формат
  - Метаданные объектов конфигурации
  - Структура модулей и их взаимосвязей
  - Граф зависимостей

### Документация
- Wiki-страницы в формате Markdown/HTML
- Навигационные файлы и индексы

### Векторные представления
- Embeddings в бинарном/CSV формате
- Индексы векторной БД
- Графовые данные (Neo4j/ArangoDB)
